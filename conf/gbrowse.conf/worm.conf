[GENERAL]

description   = C. elegans (WormBase release WS176)
db_adaptor    = Bio::DB::SeqFeature::Store
db_args       = -adaptor DBI::mysql
                -dsn     worm

# Web site configuration info
stylesheet  = /css/gbrowse.css
buttons     = /gbrowse/images/buttons
js          = /gbrowse/js
tmpimages   = /gbrowse/tmp
balloon images = /gbrowse/images/balloons
balloon tips = 1

# aggregators = processed_transcript match
plugins     = GFFDumper FastaDumper BatchDumper

quicklink plugins = GFFDumper FastaDumper

# list of tracks to turn on by default
default features = Genes

# The class of the objects used to establish the reference coordinates.
reference class  =

# examples to show in the introduction
examples = 

search attributes = Note

# "automatic" classes to try when an unqualified identifier is given
automatic classes = CDS

#image_padding = 60
pad_left   = 25
pad_right  = 25

init_code = use CGI ':standard';
            sub embed_browser {param('embedded')}
	    sub get_url {url()}
	    sub get_location {
	      param('name') || param('ref') .':'. param('start') ."..". param('end');
            }
header = sub { 
       my $embed = embed_browser();
       my $name  = get_location();
       my $url   = get_url();
       my $retval =  q(<script>).
                     q(balloon.upLeftConnector    = '/images/balloons/blue_up_bottom_left.png';).
                     q(balloon.upRightConnector   = '/images/balloons/blue_up_bottom_right.png';).
                     q(balloon.downLeftConnector  = '/images/balloons/blue_down_top_left.png';).
                     q(balloon.downRightConnector = '/images/balloons/blue_down_top_right.png';).
                     q(balloon.upBalloon          = '/images/balloons/blue_up_top.png';).
                     q(balloon.downBalloon        = '/images/balloons/blue_down_bottom.png';).
                     q(balloon.balloonWidth     = '208px';).
                     q(balloon.paddingTop       = '20px';).
                     q(balloon.paddingLeft      = '15px';).
                     q(balloon.paddingRight     = '15px';).
                     q(balloon.paddingBottom    = '20px';).
                     q(balloon.paddingConnector = '48px';).
                     q(balloon.hOffset          = 'right';).
	             q(balloon.delayTime        = 750;).
                     q(</script>);
     unless ($embed) {
       $retval .= q(<table width=100%><tr><td valign=top width=150>).
                  q(<img src="http://www.modencode.org/img/tlogo_small.png" width=100 alt="logo" border=0 alt="modENCODE logo"/>).
                  q(</td><td valign=top align=center>).
                  q(<img src="/img/modbanner2.png" border=0 alt="modENCODE banner">).
                  q(</td></tr></table>);
     }
     $retval .= q(<div class=gbrowseWrapper><h1><img src="/img/celegans_base.png" align=middle>).
                q(&nbsp;<i>C. elegans</i> Genome Browser</h1><br>);
     if ($embed) {
       $retval .= qq(<a class=header href="$url?name=$name" target="_new").
                  q(onmouseover="balloon.showTooltip(event,'Run the genome browser in a new window')">).	
                  q([Expand Genome Browser]</a>&nbsp;).
                  q(<a class=header href="http://www.modencode.org/karyotypes.html" ).
                  q(onmouseover="balloon.showTooltip(event,'Go to the karyotype view to select a new chromosome or genome')">).
                  q([Whole Genome View]</a>&nbsp;).
                  q(<a class=header href="/cgi-bin/gbrowse/fly?embedded=1").
                  q(onmouseover="balloon.showTooltip(event,'Switch to the <i>D. melanogaster</i> genome browser')">).
                  q([Fly Browser]</a>&nbsp;);
     }
     else {
      $retval .= q(<br><a class=header href="http://www.modencode.org">[modENCODE home]</a>&nbsp;).
                 q(<a class=header href="/cgi-bin/gbrowse/fly").
                 q(onmouseover="balloon.showTooltip(event,'Switch to the <i>D. melanogaster</i> genome browser')">).
                 q([Fly Browser]</a>);
     }
     $retval .=  qq(<a class=header href="http://www.wormbase.org/db/seq/gbrowse/elegans?name=$name").
                 qq(onmouseover="balloon.showTooltip(event,'Browse this region ($name) in wormbase')">[Wormbase]&nbsp;).
                 q(<a class=header href="mailto:help@modencode.org?subject=modENCODE Genome Browser (worm)").
                 q(onmouseover="balloon.showTooltip(event,'Get help or request new annotations/feature sets, etc.')">&nbsp;).
                 q([Help/Feedback]</a><br>);
     return $retval;
  }

# a footer
footer =
        </div>
        <br>
        <table width="100%">
        <TR>
        <TD align="LEFT" class="databody">
        For the source code for this browser, see the <a href="http://www.gmod.org">
        Generic Model Organism Database Project.</a>  <br>For other questions, send
        mail to <a href="mailto:mckays@cshl.org">mckays@cshl.org</a>.
        </TD>
        </TR>
        </table>
        <hr>


# Various places where you can insert your own HTML -- see configuration docs
html1 =  sub {if (embed_browser) {"<input type=hidden name='embedded' value='1'>"}}
html2 =
html3 =
html4 =
html5 =
html6 =

# what image widths to offer
image widths  = 450 500 600 640 100 1024

# default width of detailed view (pixels)
default width = 600

# max and default segment sizes for detailed view
max segment     = 5000000
default segment = 5000

# zoom levels
zoom levels    = 100 200 1000 2000 5000 10000 20000 50000 100000 200000 5000000 1000000

# colors of the overview, detailed map and key
overview bgcolor = lightgrey
detailed bgcolor = lightgoldenrodyellow
key bgcolor      = beige

########################
# Default glyph settings
########################

[TRACK DEFAULTS]
glyph         = generic
height        = 10
bgcolor       = lightgrey
fgcolor       = black
font2color    = blue
label density = 100
bump density  = 500
# where to link to when user clicks in detailed view
link          = AUTO

################## TRACK CONFIGURATION ####################
# the remainder of the sections configure individual tracks
###########################################################
[Genes]
feature      = gene
glyph        = gene
category     = Genes
height       = 12
bgcolor      = blue
label        = sub {
		my $f = shift;
		my $dn = $f->display_name;
		my @aliases = $f->each_tag_value('Alias');
		foreach (@aliases) {
		   return "$dn ($_)" if /^\w+-\d+/;
		}
		return $dn;
	}
description  = sub {
	my $f = shift;
	my @subf = $f->get_SeqFeatures('mRNA');
	my $note;
	for my $sf (@subf) {
	   $note ||= join '; ',$sf->each_tag_value('Note');
	}
        $note;
  }
link         = http://www.wormbase.org/db/get?name=$name;class=Gene
label_transcripts =  1
das category = transcription
key          = Genes

[Genes:150000]
glyph        = generic
bump         = 0
maxdepth     = 1
stranded     = 1
label        = 0
description  = 0

[Transcripts:100000]
feature      = mRNA
glyph        = box
stranded     = 1

[Transcripts]
feature      = mRNA:Coding_transcript
category     = Genes
glyph        = cds
height       = 12
bgcolor      = blue
ignore_empty_phase = 1
das category = transcription
key          = Transcripts

[TranslationF]
glyph        = translation
global feature = 1
height       = 20
fgcolor      = purple
start_codons = 0
strand       = +1
arrow_height = 2
translation  = 3frame
category     = Sequence
key          = 3-frame translation (forward)
citation     = This track shows the position of stop codons at low magnifications,
	and the 3-frame translation at high magnifications.  Only the forward strand
	is shown.

[DNA/GC Content]
glyph          = dna
global feature = 1
strand         = both
gc_window      = auto
height         = 40
fgcolor        = red
key            = GC Content
category       = Sequence

[TranslationR]
glyph        = translation
global feature = 1
height       = 20
fgcolor      = blue
strand       = -1
start_codons = 0
arrow_height = 2
translation  = 3frame
category     = Sequence
key          = 3-frame translation (reverse)
citation     = This track shows the position of stop codons at low magnifications,
	and the 3-frame translation at high magnifications.  Only the reverse
	strand is shown.
